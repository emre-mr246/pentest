"""
This script reads a list of hostnames from a specified file and appends them to the system's /etc/hosts file with a given IP address. 
The script ensures that only non-empty lines from the file are used. It also checks if the script has sufficient permissions 
to modify the /etc/hosts file and raises an appropriate error if it does not. This script is useful for adding multiple virtual host entries 
to the system's hosts file.

Usage:
- Provide the path to the file containing hostnames.
- Provide the IP address that should be associated with these hostnames.
- Ensure you have the necessary permissions (e.g., run with sudo).

Example:
    IP Address: 127.0.0.1
    vHost File: hostnames.txt
"""

#!/usr/bin/env python3

import os


def read_lines(file_path):
    with open(file_path, "r") as file:
        lines = file.readlines()
    return [line.strip() for line in lines if line.strip()]


def append_to_hosts(ip_address, hostnames):
    hosts_entry = f"{ip_address} " + " ".join(hostnames) + "\n"

    if not os.access("/etc/hosts", os.W_OK):
        raise PermissionError("Insufficient permissions. You may need to run this script with sudo.")
    with open("/etc/hosts", "a") as hosts_file:
        hosts_file.write(hosts_entry)


def main(file_path, ip_address):
    try:
        hostnames = read_lines(file_path)
        if hostnames:
            append_to_hosts(ip_address, hostnames)
            print(f"Hostnames successfully added to /etc/hosts with IP address {ip_address}.")
        else:
            print("The file is empty or contains no valid hostnames.")
    except PermissionError as e:
        print(f"Error: {e}")
    except Exception as e:
        print(f"An error occurred: {e}")


ip_address = input("IP Address: ")
file_path = input("vHost File: ")

main(file_path, ip_address)
